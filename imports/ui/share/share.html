<template name="share">
  {{#contentFor "headerButtonLeft"}}
  {{>ionNavBackButton}}
  {{/contentFor}}

  {{#contentFor "headerButtonRight"}}

  {{/contentFor}}

  {{#contentFor "headerTitle"}}
  <h1 class="title">{{_ "share"}}</h1>
  {{/contentFor}}

{{#if dataReady}}
  {{#ionView}}
  {{#ionContent}}

<div class="list" data-snap-ignore="true">

  <div class="item item-divider">
    <i class="icon fa fa-share"></i> {{_ "share content with your network"}}
  </div>

  {{> shareAdd}}

{{#if newsId}}
  <div class="card">
    {{#with scope.new}}
    <div class="item {{#if imageDoc authorNews._id._str}}item-avatar{{/if}}">
      {{#if imageDoc authorNews._id._str}}
      {{> imgDoc profilThumbImageUrl=authorNews.profilThumbImageUrl resized="80x80"}}
      {{/if}}
      <h2>
        {{#if equals targetIsAuthor 'true'}}
        <a href="{{pathFor 'detailList' _id=target.id scope=target.type}}" class="dark">{{#if name}}{{name}}{{else}}{{authorNews.name}}{{/if}}</a>
        {{else}}
        <a href="{{pathFor 'detailList' _id=authorNews._id._str scope='citoyens'}}" class="dark">{{#if name}}{{name}}{{else}}{{authorNews.name}}{{/if}}</a>
        {{/if}}
      </h2>
      <p><i class="icon ion-clock"></i> {{livestamp created}}</p>
    </div>
    {{#if photoNewsAlbums}}
    <div class="item item-body">
      {{#each photoNewsAlbums}}
    <img src="{{urlImageCommunecter}}/upload/{{moduleId}}/{{folder}}/{{name}}" class="full-image photo-viewer" />
      {{/each}}
    </div>
    {{/if}}
    {{#if text}}
    <div class="item item-body">
      {{{textMentions (autolinker text)}}}
      {{#if tags}}
      <p>
      {{#each tags}}
      <a href="" class="positive"><i class="icon ion-pound"></i> {{this}}</a>
      {{/each}}
    </p>
      {{/if}}
    </div>
    {{/if}}
      {{/with}}
  </div>
  {{else}}
  {{> scopeCard class="card" scope=scope shareVisible=true}}
  {{/if}}
</div>
  {{/ionContent}}
  {{/ionView}}
  {{else}}
{{> loading}}
{{/if}}
</template>

<template name="shareAdd">
{{#autoForm id="addShare" schema=SchemasShareRest type="method" meteormethod="shareEntity" template="ionic" class=""}}
{{> afQuickField name='comment' label-type='placeholder' rows=2}}
<div class="item">
  <div class="button-bar">
    <button type="submit" class="button button-dark">{{_ "share"}}</button>
  </div>
</div>
{{/autoForm}}
</template>
